GRAPH WAVENET TRAINING - PRETRAIN + FINETUNE
================================================================================
Device: cuda
Experiment: graphwavenet_20260120_195233

================================================================================
LOADING DATA
================================================================================
C:\Users\MSII\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\base.py:442: InconsistentVersionWarning: Trying to unpickle estimator StandardScaler from version 1.6.1 when using version 1.7.2. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(
Data mode: seq
Train samples: 7927 (x shape (7927, 12, 207, 2), y shape (7927, 12, 207, 2))
✓ Data shapes verified:
  Input:  torch.Size([16, 12, 207, 2])
  Target: torch.Size([16, 12, 207, 2])
  Adjacency: torch.Size([207, 207])

================================================================================
CREATING MODEL
================================================================================
✓ Model created with 366,904 parameters

================================================================================
STAGE 1: PRETRAINING ON SHORTER HORIZON (30 minutes)
================================================================================
Data mode: seq
Train samples: 7927 (x shape (7927, 12, 207, 2), y shape (7927, 6, 207, 2))
Pretrain Epoch   1/60 - Loss: 0.2547 | Val MAE: 3.7649, RMSE: 8.3390, MAPE: 9.41% ✓ BEST
Pretrain Epoch   2/60 - Loss: 0.2077 | Val MAE: 3.6083, RMSE: 7.9944, MAPE: 8.80% ✓ BEST
Pretrain Epoch   3/60 - Loss: 0.1980 | Val MAE: 3.6231, RMSE: 8.1486, MAPE: 8.87% 
Pretrain Epoch   4/60 - Loss: 0.1925 | Val MAE: 3.4796, RMSE: 7.8500, MAPE: 8.22% ✓ BEST
Pretrain Epoch   5/60 - Loss: 0.1903 | Val MAE: 3.5426, RMSE: 7.9644, MAPE: 8.30% 
Pretrain Epoch   6/60 - Loss: 0.1890 | Val MAE: 3.4864, RMSE: 7.9836, MAPE: 7.95% 
Pretrain Epoch   7/60 - Loss: 0.1882 | Val MAE: 3.4908, RMSE: 7.9244, MAPE: 8.20% 
Pretrain Epoch   8/60 - Loss: 0.1868 | Val MAE: 3.4820, RMSE: 7.9241, MAPE: 8.22% 
Pretrain Epoch   9/60 - Loss: 0.1845 | Val MAE: 3.5142, RMSE: 7.8267, MAPE: 8.08% 
Pretrain Epoch  10/60 - Loss: 0.1850 | Val MAE: 3.4541, RMSE: 7.9316, MAPE: 8.08% ✓ BEST
Pretrain Epoch  11/60 - Loss: 0.1842 | Val MAE: 3.4982, RMSE: 7.9663, MAPE: 8.12% 
Pretrain Epoch  12/60 - Loss: 0.1836 | Val MAE: 3.4533, RMSE: 7.9047, MAPE: 8.32% ✓ BEST
Pretrain Epoch  13/60 - Loss: 0.1826 | Val MAE: 3.4787, RMSE: 7.9690, MAPE: 8.26% 
Pretrain Epoch  14/60 - Loss: 0.1836 | Val MAE: 3.4533, RMSE: 7.9868, MAPE: 8.13% 
Pretrain Epoch  15/60 - Loss: 0.1832 | Val MAE: 3.4404, RMSE: 7.9364, MAPE: 8.22% ✓ BEST
Pretrain Epoch  16/60 - Loss: 0.1814 | Val MAE: 3.4689, RMSE: 7.8752, MAPE: 8.13% 
Pretrain Epoch  17/60 - Loss: 0.1821 | Val MAE: 3.4388, RMSE: 7.8591, MAPE: 8.08% ✓ BEST
Pretrain Epoch  18/60 - Loss: 0.1810 | Val MAE: 3.4190, RMSE: 7.9390, MAPE: 8.05% ✓ BEST
Pretrain Epoch  19/60 - Loss: 0.1796 | Val MAE: 3.4474, RMSE: 7.9021, MAPE: 7.90% 
Pretrain Epoch  20/60 - Loss: 0.1798 | Val MAE: 3.4263, RMSE: 7.8291, MAPE: 8.01% 
Pretrain Epoch  21/60 - Loss: 0.1810 | Val MAE: 3.4267, RMSE: 7.9666, MAPE: 7.95% 
Pretrain Epoch  22/60 - Loss: 0.1802 | Val MAE: 3.4367, RMSE: 7.9341, MAPE: 8.18% 
Pretrain Epoch  23/60 - Loss: 0.1798 | Val MAE: 3.4000, RMSE: 7.8926, MAPE: 7.93% ✓ BEST
Pretrain Epoch  24/60 - Loss: 0.1787 | Val MAE: 3.4828, RMSE: 7.9785, MAPE: 7.99% 
Pretrain Epoch  25/60 - Loss: 0.1786 | Val MAE: 3.4124, RMSE: 7.9711, MAPE: 7.91% 
Pretrain Epoch  26/60 - Loss: 0.1786 | Val MAE: 3.4459, RMSE: 7.9210, MAPE: 8.19% 
Pretrain Epoch  27/60 - Loss: 0.1780 | Val MAE: 3.4442, RMSE: 7.8923, MAPE: 7.90% 
Pretrain Epoch  28/60 - Loss: 0.1782 | Val MAE: 3.3913, RMSE: 7.8929, MAPE: 7.94% ✓ BEST
Pretrain Epoch  29/60 - Loss: 0.1778 | Val MAE: 3.4401, RMSE: 7.8429, MAPE: 8.09% 
Pretrain Epoch  30/60 - Loss: 0.1782 | Val MAE: 3.4423, RMSE: 7.8858, MAPE: 8.21% 
Pretrain Epoch  31/60 - Loss: 0.1786 | Val MAE: 3.4353, RMSE: 7.9515, MAPE: 8.11% 
Pretrain Epoch  32/60 - Loss: 0.1769 | Val MAE: 3.4079, RMSE: 7.9057, MAPE: 7.80% 
Pretrain Epoch  33/60 - Loss: 0.1768 | Val MAE: 3.3808, RMSE: 7.8685, MAPE: 7.95% ✓ BEST
Pretrain Epoch  34/60 - Loss: 0.1775 | Val MAE: 3.4064, RMSE: 7.8323, MAPE: 7.90% 
Pretrain Epoch  35/60 - Loss: 0.1768 | Val MAE: 3.5327, RMSE: 7.9723, MAPE: 7.95% 
Pretrain Epoch  36/60 - Loss: 0.1771 | Val MAE: 3.3787, RMSE: 7.9116, MAPE: 7.90% ✓ BEST
Pretrain Epoch  37/60 - Loss: 0.1758 | Val MAE: 3.3817, RMSE: 7.8483, MAPE: 7.97% 
Pretrain Epoch  38/60 - Loss: 0.1768 | Val MAE: 3.3748, RMSE: 7.8469, MAPE: 7.96% ✓ BEST
Pretrain Epoch  39/60 - Loss: 0.1756 | Val MAE: 3.3735, RMSE: 7.8780, MAPE: 7.88% ✓ BEST
Pretrain Epoch  40/60 - Loss: 0.1764 | Val MAE: 3.4278, RMSE: 7.9128, MAPE: 8.18% 
Pretrain Epoch  41/60 - Loss: 0.1762 | Val MAE: 3.3660, RMSE: 7.8586, MAPE: 7.91% ✓ BEST
Pretrain Epoch  42/60 - Loss: 0.1761 | Val MAE: 3.3747, RMSE: 7.8819, MAPE: 8.07% 
Pretrain Epoch  43/60 - Loss: 0.1752 | Val MAE: 3.3774, RMSE: 7.8178, MAPE: 7.90% 
Pretrain Epoch  44/60 - Loss: 0.1752 | Val MAE: 3.3722, RMSE: 7.8317, MAPE: 8.01% 
Pretrain Epoch  45/60 - Loss: 0.1752 | Val MAE: 3.3570, RMSE: 7.8460, MAPE: 7.83% ✓ BEST
Pretrain Epoch  46/60 - Loss: 0.1758 | Val MAE: 3.3912, RMSE: 7.8884, MAPE: 7.99% 
Pretrain Epoch  47/60 - Loss: 0.1743 | Val MAE: 3.4062, RMSE: 7.9265, MAPE: 7.88% 
Pretrain Epoch  48/60 - Loss: 0.1753 | Val MAE: 3.3709, RMSE: 7.8418, MAPE: 7.94% 
Pretrain Epoch  49/60 - Loss: 0.1748 | Val MAE: 3.3920, RMSE: 7.8639, MAPE: 7.77% 
Pretrain Epoch  50/60 - Loss: 0.1750 | Val MAE: 3.3665, RMSE: 7.8296, MAPE: 7.81% 
Pretrain Epoch  51/60 - Loss: 0.1746 | Val MAE: 3.3446, RMSE: 7.8321, MAPE: 7.82% ✓ BEST
Pretrain Epoch  52/60 - Loss: 0.1746 | Val MAE: 3.3726, RMSE: 7.8284, MAPE: 7.83% 
Pretrain Epoch  53/60 - Loss: 0.1746 | Val MAE: 3.3749, RMSE: 7.8575, MAPE: 7.82% 
Pretrain Epoch  54/60 - Loss: 0.1745 | Val MAE: 3.3596, RMSE: 7.8630, MAPE: 7.75% 
Pretrain Epoch  55/60 - Loss: 0.1743 | Val MAE: 3.3576, RMSE: 7.8347, MAPE: 7.93% 
Pretrain Epoch  56/60 - Loss: 0.1740 | Val MAE: 3.3613, RMSE: 7.8601, MAPE: 7.77% 
Pretrain Epoch  57/60 - Loss: 0.1744 | Val MAE: 3.3853, RMSE: 7.8224, MAPE: 8.06% 
Pretrain Epoch  58/60 - Loss: 0.1737 | Val MAE: 3.3696, RMSE: 7.8346, MAPE: 7.83% 
Pretrain Epoch  59/60 - Loss: 0.1741 | Val MAE: 3.3533, RMSE: 7.8201, MAPE: 7.77% 
Pretrain Epoch  60/60 - Loss: 0.1738 | Val MAE: 3.3894, RMSE: 7.8699, MAPE: 7.85% 

✓ Pretraining complete. Best Val MAE: 3.3446

================================================================================
STAGE 2: FINE-TUNING ON FULL HORIZON (60 minutes)
================================================================================
✓ Transferred 106 parameter tensors from pretrained model
Finetune Epoch   1/40 - Loss: 0.2451 | Val MAE: 4.0511, RMSE: 8.9226, MAPE: 10.11% ✓ BEST - saved
Finetune Epoch   2/40 - Loss: 0.2225 | Val MAE: 3.9707, RMSE: 8.9867, MAPE: 10.10% ✓ BEST - saved
Finetune Epoch   3/40 - Loss: 0.2211 | Val MAE: 3.9521, RMSE: 9.0313, MAPE: 9.85% ✓ BEST - saved
Finetune Epoch   4/40 - Loss: 0.2192 | Val MAE: 3.9663, RMSE: 8.9918, MAPE: 9.86% 
Finetune Epoch   5/40 - Loss: 0.2203 | Val MAE: 3.9626, RMSE: 9.0727, MAPE: 9.83% 
Finetune Epoch   6/40 - Loss: 0.2177 | Val MAE: 3.9499, RMSE: 8.9671, MAPE: 9.88% ✓ BEST - saved
Finetune Epoch   7/40 - Loss: 0.2175 | Val MAE: 3.9655, RMSE: 8.9897, MAPE: 9.94% 
Finetune Epoch   8/40 - Loss: 0.2178 | Val MAE: 3.9455, RMSE: 8.9928, MAPE: 9.94% ✓ BEST - saved
Finetune Epoch   9/40 - Loss: 0.2172 | Val MAE: 3.9463, RMSE: 9.0306, MAPE: 9.94% 
Finetune Epoch  10/40 - Loss: 0.2176 | Val MAE: 3.9241, RMSE: 9.0198, MAPE: 9.81% ✓ BEST - saved
Finetune Epoch  11/40 - Loss: 0.2165 | Val MAE: 3.9309, RMSE: 9.0135, MAPE: 9.78% 
Finetune Epoch  12/40 - Loss: 0.2162 | Val MAE: 3.9333, RMSE: 9.0179, MAPE: 10.02% 
Finetune Epoch  13/40 - Loss: 0.2167 | Val MAE: 3.9382, RMSE: 8.9489, MAPE: 9.90% 
Finetune Epoch  14/40 - Loss: 0.2164 | Val MAE: 3.9508, RMSE: 8.9386, MAPE: 9.97% 
Finetune Epoch  15/40 - Loss: 0.2167 | Val MAE: 4.0055, RMSE: 9.1169, MAPE: 9.71% 
Finetune Epoch  16/40 - Loss: 0.2167 | Val MAE: 3.9364, RMSE: 8.9464, MAPE: 9.89% 
Finetune Epoch  17/40 - Loss: 0.2154 | Val MAE: 3.9492, RMSE: 8.9472, MAPE: 10.02% 
Finetune Epoch  18/40 - Loss: 0.2159 | Val MAE: 3.9916, RMSE: 9.0613, MAPE: 9.81% 
Finetune Epoch  19/40 - Loss: 0.2154 | Val MAE: 3.9282, RMSE: 8.9641, MAPE: 9.79% 
Finetune Epoch  20/40 - Loss: 0.2153 | Val MAE: 3.9470, RMSE: 8.9135, MAPE: 10.07% 
Finetune Epoch  21/40 - Loss: 0.2148 | Val MAE: 3.9370, RMSE: 8.9267, MAPE: 10.06% 
Finetune Epoch  22/40 - Loss: 0.2142 | Val MAE: 3.9709, RMSE: 8.9440, MAPE: 10.10% 
Finetune Epoch  23/40 - Loss: 0.2149 | Val MAE: 3.9052, RMSE: 8.9495, MAPE: 9.83% ✓ BEST - saved
Finetune Epoch  24/40 - Loss: 0.2135 | Val MAE: 3.9122, RMSE: 8.9380, MAPE: 9.87% 
Finetune Epoch  25/40 - Loss: 0.2146 | Val MAE: 3.9427, RMSE: 8.8898, MAPE: 10.29% 
Finetune Epoch  26/40 - Loss: 0.2142 | Val MAE: 3.9270, RMSE: 8.9524, MAPE: 10.13% 
Finetune Epoch  27/40 - Loss: 0.2136 | Val MAE: 3.9156, RMSE: 8.9441, MAPE: 9.78% 
Finetune Epoch  28/40 - Loss: 0.2141 | Val MAE: 3.9309, RMSE: 8.9266, MAPE: 9.78% 
Finetune Epoch  29/40 - Loss: 0.2136 | Val MAE: 3.9098, RMSE: 8.9414, MAPE: 9.85% 
Finetune Epoch  30/40 - Loss: 0.2136 | Val MAE: 3.9008, RMSE: 8.9206, MAPE: 9.85% ✓ BEST - saved
Finetune Epoch  31/40 - Loss: 0.2133 | Val MAE: 3.9269, RMSE: 8.9782, MAPE: 9.69% 
Finetune Epoch  32/40 - Loss: 0.2133 | Val MAE: 3.9400, RMSE: 8.9515, MAPE: 10.14% 
Finetune Epoch  33/40 - Loss: 0.2127 | Val MAE: 3.9489, RMSE: 8.9587, MAPE: 10.48% 
Finetune Epoch  34/40 - Loss: 0.2132 | Val MAE: 3.9097, RMSE: 8.9011, MAPE: 9.73% 
Finetune Epoch  35/40 - Loss: 0.2127 | Val MAE: 3.8991, RMSE: 8.9136, MAPE: 9.97% ✓ BEST - saved
Finetune Epoch  36/40 - Loss: 0.2129 | Val MAE: 3.8871, RMSE: 8.8992, MAPE: 9.77% ✓ BEST - saved
Finetune Epoch  37/40 - Loss: 0.2131 | Val MAE: 3.8939, RMSE: 8.9363, MAPE: 9.76% 
Finetune Epoch  38/40 - Loss: 0.2126 | Val MAE: 3.9142, RMSE: 8.9231, MAPE: 9.81% 
Finetune Epoch  39/40 - Loss: 0.2121 | Val MAE: 3.8920, RMSE: 8.8967, MAPE: 9.99% 
Finetune Epoch  40/40 - Loss: 0.2123 | Val MAE: 3.9124, RMSE: 8.9101, MAPE: 9.73% 

✓ Fine-tuning complete. Best Val MAE: 3.8871
✓ Best model saved: ./saved_models\graphwavenet_20260120_195233_best.pt

================================================================================
FINAL TEST EVALUATION
================================================================================
c:\Users\MSII\Desktop\3CS\Netsi\Project\SOURCE_withNormOptimized\Train.py:547: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(best_model_path)

================================================================================
FINAL TEST RESULTS
================================================================================
MAE:  4.6139
RMSE: 11.8427
MAPE: 10.24%
================================================================================

✓ Predictions saved: ./plots\final_predictions_20260120_205318.npz
✓ Prediction plot saved: ./plots\final_samples_20260120_205318.png

================================================================================
✅ TRAINING COMPLETE